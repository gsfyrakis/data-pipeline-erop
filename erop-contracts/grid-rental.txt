rule "R1"
when
    e matches (botype == PurchaseQoS, originator == user,  outcome == Success)  
    PurchaseQoS in user.rights
then
    gridNode.obligs += GrantAccess("24h");  
end

rule "R2"  when  
    e matches (botype == GrantAccessTimeout,  originator == gridNode)  
    GrantAccess in gridNode.obligs  
then
    user.rights += BlackList();  
end

rule "R3"  when  
    e matches (botype == GrantAccess, originator == gridNode,  outcome == Success)  
    GrantAccess in gridNode.obligs  
then  
    gridNode.obligs -= GrantAccess;  
    user.rights += ReleaseAccess("5h");  
end

rule "R4"  when  
    e matches (botype == ReleaseAccess, originator == user,  outcome == Success)  
    ReleaseAccess in user.rights  
then
    user.rights -= ReleaseAccess;  
    success;  
end

rule "R5"  when
    e matches (ReleaseAccessTimeout, originator == user)  
    ReleaseAccess in user.rights  
then  
    user.rights -= ReleaseAccess;  
    gridNode.rights += ReleaseAccess();  
end
